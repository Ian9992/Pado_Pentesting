# DOM XSS in document.write sink using source location.search inside a select element
* This lab contains a DOM-based XSS vulnerabiltiy in the stock checker functionality. It uses the JavaScript `document.write` function. which writes data out of the page. The `document.write` function is called with data from `location.search` which you can control using the website URL. The data is enclosed within a select element.
  * To solve the lab, perform a XSS attack that breaks out of the select element and calls the `alert` function.
### 1. Capture the _POST /product/stcok_ request
![51](https://user-images.githubusercontent.com/53956303/153292658-b896fb89-f627-4865-a2cb-ad17554e7b10.png)
* From the request, it takes "productId" and "storeId"
### 2. Enumerate "storeId" from the Inspector
![52](https://user-images.githubusercontent.com/53956303/153292893-ac30f1ae-8397-4d76-b2a5-98b794dc0007.png)
* The `storeId` is extracted from `location.search` source. It then uses `docuemnt.write` to create a new option in the select element for the stock checker functionality.

### 3. Add a `storeId` query parameter to the URL and put a random alphanumeric string
![53](https://user-images.githubusercontent.com/53956303/153293457-fb5c8a05-a204-4cb0-8259-29de8f3f0093.png)
* As a result, the rendom string became an on of the options in the drop-down list.

![54](https://user-images.githubusercontent.com/53956303/153293702-ed809f1c-9d27-4c2f-aaf3-483f39229ffb.png)
### 4. Change the URL to include an XSS payload
```http
product?productId=1&storeId="></select><img src=1 onerror=alert(1)>
```
* As a result, an alert is popped up

![55](https://user-images.githubusercontent.com/53956303/153294060-b604e1ec-5886-43c4-b8a9-7068751bd81b.png)
* From the inspector, we can see that the `select` tag is closed by `"></select>`, then the JavaScript alert is injected

![56](https://user-images.githubusercontent.com/53956303/153294330-9c15b9c1-2cf0-4f75-ba4d-a01c75ee72e5.png)
* The lab is solved

![57](https://user-images.githubusercontent.com/53956303/153294417-b1815f3d-24de-4cce-8f75-0b56f3121c04.png)
