# Web cache poisoning with an unkeyed header
* this lab is vulnerable to web cache poisoning because it handles input from an unkeyed header in an unsafe way. A user visits the home page roughly once every minute. To solve this lab, poison the cache with a response that executes `alert(document.cookie)` in the visitor's browser.

### 1. Send a request to repeater to send a cache-buster query parameter
* Add any parameter like `?hack=123456` at the request and send.
	* As a result, the `X-Cache` gives `miss` as a value, and a JavaScript file `tracking.js` is stored at `/resources/js/tracing.js`

![1](https://user-images.githubusercontent.com/53956303/155614860-a606c186-3d8b-4dd2-88c9-c8f41e0362a8.png)
### 2. Run "Param Miner" extesion to find a valid header to exploit
* Use the Param Miner extensions to find a working header for Header poisoning.

![2](https://user-images.githubusercontent.com/53956303/155615278-d9c4891b-da00-40ff-9166-f0ab08907186.png)
* From the result, some useful information is found.

![3](https://user-images.githubusercontent.com/53956303/155615393-ede64086-cc5c-4b3d-9032-18fd922c5311.png)
### 3. Add a valid header to exploit
* use `X-Forwarded-Host` header with a hostname. User `hacker.com` this time.
	* From the response, the header `X-Cache:hit`, and the `X-Forwarded-Host` header has been used to dynamically genereate an absolute URL for importing a JavaScript file stored at `/resources/js/tracking.js`

![4](https://user-images.githubusercontent.com/53956303/155619134-8c9664ef-7b55-4aa8-b5d1-83ad402738a2.png)
### 4. Make a malicious payload using the provided exploit server
* At the body, insert `alert(document.cookie)`

![5](https://user-images.githubusercontent.com/53956303/155620195-71723d3f-8d6a-48d7-baef-9f3f59d9e18b.png)* And store the exploit.
### 5. Injet a malicious header to point the exploit server
* Inject the header on the request of the home page, then send the request until the exploit URl being reflected in the response and `X-Cache: hit` in the headers

![6](https://user-images.githubusercontent.com/53956303/155619994-c2179a14-72c2-4e41-aece-353c764fe63a.png)


