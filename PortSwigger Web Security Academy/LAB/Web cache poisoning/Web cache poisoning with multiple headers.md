# Web cache poisoning with multiple headers
* This lab contains a web cache poisoning vulnerability that is only exploitable when you use multiple headers to craft a malicious request. A user visits the home page roughly once a minute.
	* To solve the lab, poison the cache with a response that executes `alert(document.cookie)` in the visitor's browser.
	* The lab supports both `X-Forwarded-Host` and `X-Forwarded-scheme`
### 1. Capture the request from the home page for enumeration
![image](https://user-images.githubusercontent.com/53956303/155631179-989c5480-686f-4f1a-ba79-dd8f3a266965.png)
* The request generate `/resources/js/tracking.js`

### 2. Add a cache-buster query parameter `X-Forwarded-Host` header
* Put `X-Forwarded-Host` header with a random host. In this case, use `hacker.com`
	* It does not have any effect on the request.

### 3. Replace the cache-buster query parameter using `X-Forwarded-scheme` header
* Put random value for `X-Forwarded-scheme`.
	* As a result, a 302 response is given.
---------
