# Password brute-force via password change
* This lab's password change functionality makes it vulnerable to brute-force attacks. To solve this lab, use the list of cadidate passwords to brute-force Carlos's account and access hist "My account" page.
	* Your credentials: `wiener:peter`
	* Victim's username: `carlos`

### 1. Test the password change functionlity
* Log in as `wiener` and enumerate the behavior using the Burp Repeater.
 * When enter incorrect current password, the account is locked.

![63](https://user-images.githubusercontent.com/53956303/161647789-f284b30e-eeb3-4b2f-9302-6cacc245fb6b.png)
* Test when enter the correct password, but does not match the `new-password-1` and `new-password-2`.
	* It returns a message `New passwords do not match`

![64](https://user-images.githubusercontent.com/53956303/161647981-b5a46b40-7918-4c59-9e77-e287dc09fc5b.png)
* Because of this behavior, the attacker can brute force the current password of Carlos.
### Set up the exploit
* send the `POST /my-account/change-password` to Intruder, set the payload position, and set the payload using the password list.

![65](https://user-images.githubusercontent.com/53956303/161648377-5f7a5082-1b76-4852-bbd8-a7afca28d48c.png)
* use the password list.

![66](https://user-images.githubusercontent.com/53956303/161648462-14a560af-32cd-4f64-b4c7-14c6e1d0cd0e.png)
* Set the `Grep-Match` function to catch the message `New passwords do not match`

![67](https://user-images.githubusercontent.com/53956303/161648741-2b53ec29-275d-4e23-8fff-4f521f7bc67a.png)
* Then, start the attack. From the result, only one request have the flag for the message. It means that the payload is the current password for Carlos.

![68](https://user-images.githubusercontent.com/53956303/161648869-ed65c710-eb69-4508-9bc3-81bf91ad4d7d.png)
* Using the obtained password, access to Carlos's account is granted. As a result, the lab is solved.

![69](https://user-images.githubusercontent.com/53956303/161648983-93978ff8-9c8e-486a-a8f0-a2942ee06575.png)
