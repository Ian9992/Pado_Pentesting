# Username enumeration via response timing
* This lab is vulnreable to usernmae enumeration using its response times. To solve the lab, enumerate a valid usernmae, brute-force this user's password, then access their account page.
	* Your credentials: `wiener:peter`

### 1. Capture the login request
![25](https://user-images.githubusercontent.com/53956303/160706275-595403db-3108-4fbc-984a-64771cb93f2d.png)
* However, when a user attempts too many requests, the IP is blocked.

![26](https://user-images.githubusercontent.com/53956303/160706430-8335b3d2-368e-4830-9b9f-1e5b4ca23dba.png)
### 2. Identify if `X-Forwarded-For` header works
* The `X-Forwarded-For` header allows an attacker to spoof the IP address and bypass the IP-based bruteforce protection.
	* When the `X-Forwarded-For` header is added, the IP-based bruteforce protection is not working.

![27](https://user-images.githubusercontent.com/53956303/160707099-cad2e2e6-78bc-4b7e-a029-c43a0022811e.png)
### 3. Experimenting the response time
* When an attacker enter an invalid username, the response times are pretty much the same, but when a valid username, the response time is increased depending on the legth of the password.
	* Send therequest to Intruder and use `Pitchfork` options. Clear the default payload positions and add the `X-Forwarded-For` header.
	* Then, set the payload position to the value of the `X-Forwarded-For` header and `username`. Also change the password to a very long character.

![28](https://user-images.githubusercontent.com/53956303/160707784-c27c2c3f-7568-4fc8-951e-fc67d1ad8861.png)
### 4. Set the payload
* Select Payload 1 and select "Numbers" payload type, enter the range of 1-100 and set the step to 1. Set the "max fraction digits:0"

![29](https://user-images.githubusercontent.com/53956303/160708042-a077d6bb-fbd2-4a46-bda6-b875cd805ff3.png)
* Select Payload 2 and select "Simple list", and put the username list. Then, start the attack.

![30](https://user-images.githubusercontent.com/53956303/160708243-c34522b4-77ad-42af-b4ad-ac7e3b4a10c2.png)
### 5. Start attack and sort the result
* Click the clumns and select "Response received" and "Response Completed" options. These two columns are now sidplay in the result table.
	* From the result, only one request has a response that has a signigicantly longer response time. it means that it is the right username.

![31](https://user-images.githubusercontent.com/53956303/160709058-96721200-165c-495a-844f-245ccf865f4c.png)
### 6. Modify the setting to brute force password
* Modify the username to `arizona`, change the payload position from username to password, and load the password list.

![32](https://user-images.githubusercontent.com/53956303/160709324-9843af77-63bd-4c7f-a706-c6286ef28311.png)
* Then, start the attack. From the result, only one request has a 302 response. Which means that the payload is the right password for "arizona"

![33](https://user-images.githubusercontent.com/53956303/160709498-c3a1b5de-05b7-4ca2-99b1-15f7630d69a4.png)
* With obtained password, access to arizona's account is granted. The lab is solved.

![33](https://user-images.githubusercontent.com/53956303/160709661-7143413e-9fb9-4626-993e-9bb308c6a6e8.png)
