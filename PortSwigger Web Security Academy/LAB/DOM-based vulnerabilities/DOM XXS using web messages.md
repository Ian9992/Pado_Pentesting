# DOM XSS using web messages
* This lab demonstrate a simple web message vulnerability. To solve the lab, use the exploit server to post a message to the target site that causes the `print()` function to be called.
### 1. Enumerate the web page
* From the page source of the home page, `addEventListener()` function is found

![4](https://user-images.githubusercontent.com/53956303/154373138-fc355036-227b-48d4-8d91-5b92653234e7.png)
### 2. Create a malicious iframe using the provided exploit server
* Add this iframe to the body
```html
<iframe src="https://ac1f1f251ec882cec0a60e2f006a0003.web-security-academy.net/" onload="this.contentWindow.postMessage('<img src=1 onerror=print()>','*')">
```
![5](https://user-images.githubusercontent.com/53956303/154373522-2720bafb-7066-470a-b872-3a657d7209be.png)
* Store and deliver it to the victim
	* When the `iframe` loads, the `postMessage()` method sends a web message to the home page. The event listener, which is intended to serve ads, takes the content of the web message adn insert it into the `div` with the ID `ads`
	* However, in this case it inserts our `img` tag, which contains an invalid `src` attribute. This throws an error, which cause the `onerror` event handler to execute our payload.

* The lab is solved

![6](https://user-images.githubusercontent.com/53956303/154374107-9ff6e34c-a8c8-48b9-b2f1-1e6e3c591c2f.png)
