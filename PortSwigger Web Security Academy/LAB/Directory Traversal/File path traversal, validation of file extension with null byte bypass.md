# File path traversal, validation of file extension with null byte bypass
* This lab contains a file path traversal vulnerability in the display of product images.
* The application validates that the supplied filename ends with the exepcted file extension.
  * To solve the lab, retrieve the contents of the `/etc/passwd`

### 1. Identify the vulnerable point for the directory traversal
* From an image on a post, a possibly vulnerable parameter `filename` is found.

![18](https://user-images.githubusercontent.com/53956303/161853411-3844c6c3-8959-486f-95a4-f7d0c915e521.png)
### 2. Try a basic directory traversal technique
```http
?filename=../../../../../../../../../../etc/passwd
```
### 3. Try to put a null byte after the payload to do the directory traversal for a specific file extension 
* Since the image is in `.jpg` format, try for a jpg file extension.
```http
?filename=../../../../../../etc/passwd%00.jpg
```
* As a result, the target file is retrieved.

![19](https://user-images.githubusercontent.com/53956303/161853978-c69f8033-d9b1-4b43-861f-f8e1cf0b71e4.png)
* As a result, the lab is solved.

![20](https://user-images.githubusercontent.com/53956303/161854047-90b06f13-20fa-41a2-a68e-3537fc7a05a3.png)
