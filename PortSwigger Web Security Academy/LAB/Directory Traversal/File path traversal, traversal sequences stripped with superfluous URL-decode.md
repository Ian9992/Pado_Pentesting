# File path traversal, traversal sequences stripped with superfluous URL-decode
* This lab contains a file path traversal vulnerability in the display of product images. The application blocks input containing path traversal sequences. it then performs a URL-decode of the input before using it.
	* To solve the lab, retrieve the contents of the `/etc/passwd` file.

### 1. Identify the vulnerable point for the directory traversal
* From an image on a post, a possible vulnerable parameter `filename` is found

![11](https://user-images.githubusercontent.com/53956303/161848041-d4d0724e-7fa7-4358-96fd-47f51486666d.png)
### 2. Test for the basic directory traversal
* Try for the basic and absolute path directory traversal.
```http
?filename=../../../../../etc/passwd
?filename=/etc/passwd
```
* Both does not work.
### 3. Encode the payload 
* Double URL encode the directory traversal sequences and the filename.
```http
?filename=%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fpasswd
```
* As a result, the target file is retrieved.

![12](https://user-images.githubusercontent.com/53956303/161848874-aa6ed0de-5020-4657-9be6-6bbf3a11f789.png)
* As a result, the lab is solved.

![13](https://user-images.githubusercontent.com/53956303/161848986-1166148d-1c2e-4089-8292-67e81d5bc3c2.png)
