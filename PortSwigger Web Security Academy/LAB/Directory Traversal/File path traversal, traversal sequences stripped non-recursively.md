# File path traversal, traversal sequnces stripped non-recursively
* This lab contains a file path traversal vulnerability in the display of product images.
* This application strips path traversal sequences from the user-supplied filename before using it.
	* To solve the lab, retrieve the contents of the `/etc/passwd` file.

### 1. Find the vulnerable point for the directory traversal
* From an image form a post, a possible vulnerable parameter `filename` is found.

![8](https://user-images.githubusercontent.com/53956303/161843571-15a6805f-108e-4986-9fd7-b977505ded71.png)
### 2. Try a common directory traversal sequnces to retrieve the target file
* Try a common traversal sequnces and the absolute path for the directory traversal.
```http
?filename=../../../../../../../etc/passwd
?filename=/etc/passwd
```
* Both does not work.
### 3. Try another technique to avoid defense
```http
?filename=....//....//....//....//....//....//etc/passwd
```
* As a result, the target file is retrieved.

![9](https://user-images.githubusercontent.com/53956303/161844460-2d4d85c6-fd9f-4898-8383-0fbe9f685e1c.png)
* In some contextx, such as in a URL path or the `filename` parameter of a `multipart/form-data` request, web servers may strip any and directory traversal sequences before passing your input into the application.
	* You can sometimes bypass this kind of sanitization by URL encoding, or even double URL encoding the `../` characters. resulting in `%2e%2e%2f` or `%252e%252e%252f` respectively. Various non-standard encodings, such as `..%c0%af` or `..%ef%bc%8f`, may also do the trick.

* As a result, the lab is solved.

![10](https://user-images.githubusercontent.com/53956303/161845532-576415dc-f955-4a10-9066-e9b2112ff59d.png)
