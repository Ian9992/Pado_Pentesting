# Basic password reset poisoning
* This lab is vulnerable to password reset poisoning. The user _carlos_ will carelessly click on any links in emails that he receives. To solve the lab, log in to Carlos's account.
	* You can log in to your own account using the following credentials `wiener:peter`. Any emails sent to this account can be read via the email client on the exploit server.

### 1. Enumerate the web page's functionalities
* At the login panel, a "Forgot password?" funtionality is found.

![1](https://user-images.githubusercontent.com/53956303/156248220-9a4e21d5-4d21-4e89-bbee-9dbefbe887b6.png)
* When click the "Forgot password?", a panel to enter an username or email is found.
	* Use the provided username "wiener"

![2](https://user-images.githubusercontent.com/53956303/156248880-51f22fe8-6e1b-43c3-acf1-171c81d69ff5.png)
* As a result, the email client in the exploit server, a link containing `temp-forgot-password-token` is given.

![3](https://user-images.githubusercontent.com/53956303/156249006-323779fd-c661-477a-8381-cdf812940134.png)


### 2. Modify `POST /forget-password` request
* This request is used to trigger the password reset email. It contains the username of a requested user as a body parameter.
	* Test if the request works when the Host header is modified
	* Use arbitrary Host header `testing`

![4](https://user-images.githubusercontent.com/53956303/156251292-978217d1-46f8-4796-a29a-557c9ccb240f.png)
* it works!

![5](https://user-images.githubusercontent.com/53956303/156251386-626e4b54-3612-473c-8422-b588dc8aaad6.png)
* Since the Host header can be modified, use it to exploit.
	* To change the target username to change the password, modify the username paramter to `username=carlos` and the Host header to the exploit server address.

![4](https://user-images.githubusercontent.com/53956303/156250996-d3e03b14-75a9-4180-8084-aff8b16eb8fb.png)
* As a result, when the Carlos click the request, a `temp-forgot-password-token` has been made. It can be found from the access log. 

![6](https://user-images.githubusercontent.com/53956303/156251586-94811c50-3810-45ba-beaa-08393308333b.png)
### 3. Access the password change panel to change Carlos's password.
* Using the provided token, the password change panel is found on `https://ac101f791fe6dd9dc0d9c9ac0017000f.web-security-academy.net/forgot-password?temp-forgot-password-token=15vP3oATqCpuAgvQDfBafqvCTVuJUyg3`
	* Chnage password to `test123`
![7](https://user-images.githubusercontent.com/53956303/156251873-ca00df61-4633-453d-a2f1-0b1e1564a157.png)
* Then, login as Carlos with changed password.
	* As a result, the lab is solved.

![8](https://user-images.githubusercontent.com/53956303/156252038-c81f374c-45d3-4b77-a17c-42594b7a6b68.png)


