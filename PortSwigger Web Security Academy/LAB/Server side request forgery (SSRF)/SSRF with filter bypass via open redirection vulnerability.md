# SSRF with filter bypass via open redirection vulnerability
* This lab has a stock check feature which fetches data from an internal system.
	* To solve the lab, change the stock check URL to access the admin interface at `http://192.168.0.12:8080/admin` and delete the user _carlos_
	* The stock checker has ben restricted to only access the local application, so you will need to find an open redirect affecting the application first.

### 1. Get _POST /product/stock_ request
![23](https://user-images.githubusercontent.com/53956303/152617911-78debf0e-53b3-4178-9f37-9560a2a283ce.png)
* Then, send it to repeater to modify.

### 2. Enumerate the web page
* From clicking a "Next Product" button, a request `GET /product/nextProduct?currentProductId=1&path=/product?productId=2` is found.

![24](https://user-images.githubusercontent.com/53956303/152618645-6df5e9ea-72d0-45ea-99b2-0a0a1f09cb36.png)
* It might be used to bypass the filter and redirect to admin panel

![25](https://user-images.githubusercontent.com/53956303/152618695-c290c495-8d82-4d81-ab2b-a3ac341355ed.png)
### 3. Use the _StockApi_ to redirects to the admin interface
* Put the value of _path_ parameter obtained into _stockApi_
```http
/product/nextProduct?currentProductId=1&path=http://192.168.0.12:8080/admin
```
![26](https://user-images.githubusercontent.com/53956303/152618892-bf642551-dbcb-4e0e-98b2-fb7eabfc9aef.png)
* Then, send the request.
	* As a result, the redirection is made to the `http://192.168.0.12:8080/admin`

![27](https://user-images.githubusercontent.com/53956303/152618996-59ddf589-b870-4d55-9661-e2b28a088729.png)
### 4. Delete _carlos_ account
* Modify the value of _path_ parameter in the _stockApi_ to delete _carlos_
```http
/product/nextProduct?currentProductId=1&path=http://192.168.0.12:8080/admin/delete?username=carlos
```
![28](https://user-images.githubusercontent.com/53956303/152619141-45b65fda-5081-4fb3-bbc5-9af03a752fcb.png)

* When the request is sent, _calros_ account is deleted and the lab is solved.

![29](https://user-images.githubusercontent.com/53956303/152619165-8fe34473-f2d9-45f7-bd42-d24d3e28e1ec.png)
