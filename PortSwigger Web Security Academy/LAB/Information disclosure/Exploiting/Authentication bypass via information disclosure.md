# Authentication bypass via information disclosure
* This lab's administration interface has an authentication bypass vulnerability, but it is impractical to exploit without knowledge of a custom HTTP header used by the front-end.
  * To solve the lab, obtain the header name then use it to bypass the lab's authentication. Access the admin interface and delete Carlos's account.
    * Provided credentials: `wienere:peter` 
### 1. Try to access `/admin` directory
* It gives a access deny message. Only localhost can access the `/admin`

![11](https://user-images.githubusercontent.com/53956303/151643653-3d493714-da34-41b0-9481-fba88206f225.png)
* It returns 401 status code

![12](https://user-images.githubusercontent.com/53956303/151643661-e4bea873-28ac-4b70-8b4f-2d496598f5ac.png)
### 2. Send this request to Repeater
* Send the request with _TRACE /admin_ header

![13](https://user-images.githubusercontent.com/53956303/151643788-76eb55c4-296d-4b2e-b781-16154042148c.png)
* From the result, an interesting header which contains my IP address is found `X-Custom-IP-Authorization: MY-IP-ADDRESS`
  * It is used to identify the request is from the _localhost_ or not.
### 3. Configure the Proxy
* At the `Proxy -> Options`, configure the `Match and Replace`. Click `Add`
  * Leave the match condition blank
  * Modify `Replace` to `X-Custom-IP-Authorization: 127.0.0.1`

![14](https://user-images.githubusercontent.com/53956303/151643935-90e864fd-e83e-4329-bb8e-02b3f4b71239.png)
* As a result, the added header will be added to every request an attacker send.

### 4. Access `/admin` again
* As a result, access to the _Admin panel_ is granted

![15](https://user-images.githubusercontent.com/53956303/151644001-a4dc65b9-db50-4c8d-b8aa-50a1af3b7f12.png)
### 5. Delte "Carlos" account
* when delete the account, the lab is solved

![16](https://user-images.githubusercontent.com/53956303/151644021-57b02b48-602a-4227-ac36-2eda757cf6c1.png)

