# Server-side template injection with information disclosure via user-supplied objects
* This lab is vulnerable to server-side template injection due to the way an object is being passed into the template. This vulnerability can be exploited to access sensitive data.
	* To solve the lab, steal and submit the framework's scret key.
	* You can log in to your own account using the following credentials: `content-manager:C0nt3ntM4n4g3r`

### 1. Enumerate the web page as "Content-manager"
* From a product page, a "Edit template" function is found.

![21](https://user-images.githubusercontent.com/53956303/155416547-e8eca4e4-c814-4961-9e07-04c73bd17f71.png)
* At the end of the template, some interesting obejcts `{{product.stock}}, {{product.name}}, and {{product.prict}}` are found. They load the data from the server to present on a post.

![22](https://user-images.githubusercontent.com/53956303/155416907-51a86144-44bb-4ed5-bcdb-4c73763a2746.png)
### 2. Test to identify which template engine is using
* Try to put `{{7*7}}`. As a result, an error message from the Python based Django template engine is given.

![23](https://user-images.githubusercontent.com/53956303/155417224-ebcd681e-17ec-4b69-bf87-c69388c43571.png)
### 3. Exploit the Django template engine
* From [A Pentester's Guide to Server side template injection (SSTI) - Cobalt](https://cobalt.io/blog/a-pentesters-guide-to-server-side-template-injection-ssti), an exploit to obtain a secret key for Django template engine is found.
```python
{{settings.SECRET_KEY}}
```
* Use this to obtain the secret key.
	* As a result, the secret key is given.

![24](https://user-images.githubusercontent.com/53956303/155417825-dab05fd1-493b-4121-a6b7-ed91b2a7c205.png)
* By submitting the key, the lab is solved.

![25](https://user-images.githubusercontent.com/53956303/155417912-4ac53daf-d47a-472d-b4d5-d57aa064583b.png)
