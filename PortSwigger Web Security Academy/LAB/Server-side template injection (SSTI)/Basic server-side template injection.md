# Basic Server-side template injection
* This lab is vulnerabe to server-side template injection due to the unsafe construction of an ERB template.
	* To solve the lab, review the ERB document to find out how to execute arbitrary code, then delete the `morale.txt` file from the Carlos's home directory.

### 1. Enumeate the webpage
* When the first product "Couple's Umbrella" is being clicked, it returns a message that announce this product is out of stock.
	* Also, from the URL, a possibly vulnerable parameter `message` is found

![3](https://user-images.githubusercontent.com/53956303/155250360-d7860d38-e13d-49a0-b40d-0bbdf69ff4c8.png)

### 2. Test the paramter
* test the parameter by putting some string

![4](https://user-images.githubusercontent.com/53956303/155250605-7fbbcc37-3acb-43fc-b7a3-b88fd720af13.png)
* It works! it echoes the input
### 3. Test for a ERB engine
* Try to put a special formatted value for ERB template
```ruby
<%=foobar%>
```
* As an ERB error message is given. which means that the ERB engine is used on this web page

![5](https://user-images.githubusercontent.com/53956303/155251104-e82ab19e-9054-4eab-abfb-72d56180e181.png)
### 4. Exploit the ERB engine
* From Google, a [Pentester's Guide to Server Side Template Injection (SSTI) - Cobalt](https://cobalt.io/blog/a-pentesters-guide-to-server-side-template-injection-ssti) is found.
	* From the page, an exploit for ERB engine is found
```ruby
<%= system("whoami") %>
```
* Test it on the web page.

![6](https://user-images.githubusercontent.com/53956303/155251445-96012eb6-a84c-4786-92b6-9687ee4d7500.png)
 * It works!

### 5. Use this RCE to delete the target file (/home/carlos/morale.txt)
```bash
<%= system("rm /home/carlos/morale.txt") %>
```
* As a result, the file is deleted and the lab is solved.

![7](https://user-images.githubusercontent.com/53956303/155251540-616c6a45-ca56-4587-91ac-bf8fedfa55ca.png)

