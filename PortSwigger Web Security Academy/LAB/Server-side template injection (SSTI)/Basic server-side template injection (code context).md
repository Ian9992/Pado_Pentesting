Basic server-side template injection (code context)
* This lab is vulnerable to server-side template injection due to the way it unsafely uses a Tornado template.
	* To solve the lab, review the Tornado documentation to discover how to execute arbitrary code, then delete the `morale.txt` file from carlos's home directory.
	* You can log in to your own account using the following credentials `wiener:peter`

### 1. Enumerate the website as wiener
* Browse the website and enumerate "HTTP history" to find something interesting.
	* From the `POSt /my-account/change-blog-post-author-display`, a possibly vulnerable parameter is found.

![8](https://user-images.githubusercontent.com/53956303/155399380-46b82c30-6f47-4a66-b0c2-a5e9287fd9d0.png)
### 2. Try to test templates
* Try to put `{7*7}` concatenate after the value of `blog-post-author-display`
	 * After that, post a test comment to see the username. However, from the result, the web page gives a Tornado application error.

![9](https://user-images.githubusercontent.com/53956303/155401952-b10c2cbf-8336-4414-96ac-769a36e03b9e.png)
### 3. Exploit the Tornado engine
* From [Pentester's Guide to Server side template injection - Cobalt](https://cobalt.io/blog/a-pentesters-guide-to-server-side-template-injection-ssti), some exploti for a Python based engine, Tornado, is found.
```python
{% import os %}{{os.system('whoami')}}
```
* Since the error gives some information about how the injected code made the error message, close the original context and inject the payload
```python
}}{% import os %}{{os.system('rm /home/carlos/morale.txt')}}
```
* As a result, the target file is deleted and the lab is solved.

![10](https://user-images.githubusercontent.com/53956303/155403158-77799dc6-4b2c-42ca-b096-58b7e0d924a1.png)
