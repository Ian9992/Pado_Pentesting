# Method-based access control can be circumvented
* This lab implements access controls based partly on the HTTP method of requests. You can familiarize yourself with the admin panel by logging in using the credentials: _administrator: admin_
	* To solve the lab, log in using the credentials _wiener:peter_ and exploit the flawed access control to promote yourself to become an administrator

### 1. Login the web server as Admin and capture the request when upgrad _carlos_'s privilege
![16](https://user-images.githubusercontent.com/53956303/152044157-71c3635d-b75c-47f8-9a9f-714bb1a9aa04.png)
* Send the _POST /admin-roles_ to repeater

### 2. Open the Admin panel agaim with another Private tab
* Then, login as a normal user _wiener_ and copy the session cookie
	* `uuk1YIwThL1aUwqcaPnDind9JtqdUiSj`

![17](https://user-images.githubusercontent.com/53956303/152045265-7a6592e1-5f9c-44cf-9c92-d4443199295e.png)
### 3. Paste the _wiener_'s session cookie to the _POST /admin-roles_ request in the reapeater

![18](https://user-images.githubusercontent.com/53956303/152045375-a5da8219-44dc-458f-8a99-9f0aa58ca34d.png)
* Then, send the request
	* As a result, 401 status code "Unauthorized" is given

![19](https://user-images.githubusercontent.com/53956303/152045505-b9844ccb-ee97-4fd9-be39-902ad6f5297b.png)
### 4. Change the request from _POST /admin-roles_ to _POSTX /admin-roles_ (Using a normal user's cookie again)
* It returns different response. "Missing parameter 'username'"

![20](https://user-images.githubusercontent.com/53956303/152045858-779e0fbb-c683-4a26-828c-bcbeff2c2c73.png)
### 5. Use "Change request method"
* Right click on the reqeust to change the request method, and change the _username=_parameter to _wiener_
	* It became a _GET /admin-roles_ request

![21](https://user-images.githubusercontent.com/53956303/152046335-0537d556-681a-4317-be31-ee7fbbce7f90.png)
* When send the request, the response returns 302 found status code
	* Also, _wiener_ user got the admin prvilege

![22](https://user-images.githubusercontent.com/53956303/152046567-d9b597e0-3661-4d4e-8627-e4097b74d278.png)
* The lab is solved

![23](https://user-images.githubusercontent.com/53956303/152046656-2000a30f-9ed0-4b7e-8b6e-e7224a017cd3.png)
