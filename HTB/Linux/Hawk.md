# Hawk
## Reconnaissance
### Use NmapAutomator for initial Scanning
```bash
sudo ./nmapAutomator.sh 10.10.10.102 All
```
* Result

![1](https://user-images.githubusercontent.com/53956303/132576780-1034fe2b-1344-4997-8bd4-ad7d1711f529.png)
![2](https://user-images.githubusercontent.com/53956303/132576842-5cb62bcf-5d3a-4586-8737-71a682418134.png)
## Enumeration
## Port 21
### FTP Enumeration
#### Access to FTP as Anonymous
```bash
ftp 10.10.10.102
ls -la
```
From the FTP server, a directory "messages" is found
#### Enumerate "messages" directory
* From the directory, a file `.drupal.txt.enc` is found
  * Download the file to enumerate
```bash
cd messages
get .drupal.txt.enc
```
![3](https://user-images.githubusercontent.com/53956303/132581149-27223f96-adc8-4a5c-b2cd-fa70aa31f068.png)

### Enumerate the file
```bash
file .drupal.txt.enc
```
* That file is a openssl base64 encoded salted password

![4](https://user-images.githubusercontent.com/53956303/132581054-82c2d249-ec28-4ee4-b4af-faa5644eb51b.png)
### Decode the file using base64
```bash
cat .drupal.txt.enc | base64 -d > drupal.txt.decoded
```
#### Confirm the file
```bash
file drupal.txt.decoded
```
* it became openssl salted password

![5](https://user-images.githubusercontent.com/53956303/132581708-c3d0b70a-2e11-4ca3-9ae9-ad11da490400.png)
### Crack the Openssl encrypted data with salted password
#### Install "bruteforce-salted-openssl" to crack the Openssl salted password
* Install an application to crack the file
```bash
sudo apt-get install bruteforce-salted-openssl
```
#### Use the application to crack
* use `-f` flag for a word list (Dictionary mode)
```bash
bruteforce-salted-openssl -f /usr/share/wordlists/rockyou.txt drupal.txt.decoded
```
* However, the password is not cracked

![6](https://user-images.githubusercontent.com/53956303/132582276-391e1e0a-e65f-4d02-a0c9-290df1832a2e.png)
#### Use sha256 option
* Since the result from the bruteforce mentioned a default digest, use SHA256 which is default digest for OpenSSL 1.1.x
```bash
bruteforce-salted-openssl -f /usr/share/wordlists/rockyou.txt -d sha256 drupal.txt.decoded
```
* From the result, a password candidate is found
  * `friends`    

![7](https://user-images.githubusercontent.com/53956303/132582792-38c8c741-0237-44dc-9de2-c56c49bd8825.png)
### Decrypt the file using password
* The digest is SHA256 and cipher used is _AES-256-CBC_ because that is the default cipher that the progrtam uses if it is not specified
```bash
openssl enc -d -a -AES-256-CBC -in .drupal.txt.enc -k friends
```
* From the result, a password for the portal is found
  * `PencilKeyboardScanner123`

![8](https://user-images.githubusercontent.com/53956303/132583398-a81811a7-0396-45bd-a00b-caf77364d9ae.png)
## Port 80
* From the Port 80, 
